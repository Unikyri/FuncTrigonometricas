<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora Interactiva de Triángulo Rectángulo</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      background: #3f51b5;
      color: #fff;
      width: 100%;
      padding: 1rem;
      text-align: center;
    }
    .contenedor {
      margin: 2rem;
      position: relative;
      width: 320px;
      height: 320px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    /* Estilos para el SVG */
    svg {
      width: 100%;
      height: 100%;
    }
    /* Posicionamiento de los inputs sobre el triángulo */
    .input-field {
      position: absolute;
      width: 60px;
      text-align: center;
      font-size: 0.9rem;
    }
    /* Campo para el lado izquierdo (y) */
    #input-y {
      top: 130px;  /* aprox. a mitad del lado vertical */
      left: -70px;
    }
    /* Campo para el lado inferior (x) */
    #input-x {
      bottom: -40px;
      left: 130px;
    }
    /* Campo para la hipotenusa (h) */
    #input-h {
      top: 40px;
      right: -70px;
    }
    /* Campo para el ángulo A (vértice superior izquierdo) */
    #input-A {
      top: -40px;
      left: 10px;
      width: 50px;
    }
    /* Campo para el ángulo B (vértice inferior derecho) */
    #input-B {
      bottom: -40px;
      right: 10px;
      width: 50px;
    }
    .btn-calcular {
      margin: 1rem;
      padding: 0.8rem 1.2rem;
      background: #3f51b5;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn-calcular:hover {
      background: #303f9f;
    }
    .resultado {
      max-width: 600px;
      background: #fff;
      padding: 1rem;
      border-radius: 5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      margin-bottom: 2rem;
    }
    .resultado h3 {
      margin-top: 0;
    }
    .error {
      color: red;
      text-align: center;
      margin-top: 1rem;
    }
    .simbolo {
      font-style: italic;
      color: #555;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Calculadora de Triángulo Rectángulo</h1>
    <p>Ingresa los valores directamente en el dibujo</p>
  </header>

  <!-- Contenedor con el triángulo y campos de entrada -->
  <div class="contenedor">
    <!-- SVG con el triángulo -->
    <svg viewBox="0 0 300 300">
      <!-- Triángulo con vértice A (50,50), B (50,250) y C (250,250) -->
      <polygon points="50,50 50,250 250,250" fill="#e8f0fe" stroke="#3f51b5" stroke-width="2" />
      <!-- Marcas para el ángulo recto en B -->
      <polyline points="50,250 70,250 70,230" fill="none" stroke="#3f51b5" stroke-width="2"/>
      <!-- Líneas punteadas para indicar las medidas (opcional) -->
      <line x1="50" y1="50" x2="50" y2="250" stroke-dasharray="4" stroke="#999" />
      <line x1="50" y1="250" x2="250" y2="250" stroke-dasharray="4" stroke="#999" />
      <line x1="50" y1="50" x2="250" y2="250" stroke-dasharray="4" stroke="#999" />
    </svg>

    <!-- Inputs posicionados sobre el triángulo -->
    <input id="input-y" class="input-field" type="number" step="any" placeholder="y" title="Cateto (vertical)" />
    <input id="input-x" class="input-field" type="number" step="any" placeholder="x" title="Cateto (horizontal)" />
    <input id="input-h" class="input-field" type="number" step="any" placeholder="h" title="Hipotenusa" />
    <input id="input-A" class="input-field" type="number" step="any" placeholder="A°" title="Ángulo A (vértice superior)" />
    <input id="input-B" class="input-field" type="number" step="any" placeholder="B°" title="Ángulo B (vértice inferior derecho)" />
  </div>

  <button class="btn-calcular" onclick="calcular()">Calcular</button>
  <div id="mensaje-error" class="error"></div>

  <!-- Resultados -->
  <div id="resultados" class="resultado" style="display:none;">
    <h3>Resultados (valores redondeados a entero)</h3>
    <p><strong>Cateto horizontal (x):</strong> <span id="resX"></span> <span id="simX" class="simbolo"></span></p>
    <p><strong>Cateto vertical (y):</strong> <span id="resY"></span> <span id="simY" class="simbolo"></span></p>
    <p><strong>Hipotenusa (h):</strong> <span id="resH"></span> <span id="simH" class="simbolo"></span></p>
    <p><strong>Ángulo A (°):</strong> <span id="resA"></span></p>
    <p><strong>Ángulo B (°):</strong> <span id="resB"></span></p>
    <h4>Funciones trigonométricas</h4>
    <table border="1" cellpadding="5">
      <thead>
        <tr>
          <th></th>
          <th>sen</th>
          <th>cos</th>
          <th>tan</th>
          <th>csc</th>
          <th>sec</th>
          <th>cot</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Ángulo A</th>
          <td id="senA"></td>
          <td id="cosA"></td>
          <td id="tanA"></td>
          <td id="cscA"></td>
          <td id="secA"></td>
          <td id="cotA"></td>
        </tr>
        <tr>
          <th>Ángulo B</th>
          <td id="senB"></td>
          <td id="cosB"></td>
          <td id="tanB"></td>
          <td id="cscB"></td>
          <td id="secB"></td>
          <td id="cotB"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <script>
    // Función para convertir grados a radianes y viceversa
    function degToRad(grados) {
      return (grados * Math.PI) / 180;
    }
    function radToDeg(radianes) {
      return (radianes * 180) / Math.PI;
    }

    // Función para simplificar expresiones de la forma √n
    // Si n es divisible por algún cuadrado perfecto, se extrae ese factor.
    function simplifyRadical(n) {
      n = Math.round(n); // trabajamos con enteros
      // Si es un cuadrado perfecto, devolvemos el entero
      let raiz = Math.floor(Math.sqrt(n));
      if (raiz * raiz === n) {
        return `${raiz}`;
      }
      // Buscar el mayor cuadrado perfecto divisor
      for (let i = raiz; i >= 2; i--) {
        if (n % (i * i) === 0) {
          let factor = i;
          let restante = n / (i * i);
          return `${factor}√${restante}`;
        }
      }
      // Si no se pudo extraer factor
      return `√${n}`;
    }

    // Función principal de cálculo
    function calcular() {
      // Obtener valores de cada input (si no se ingresa nada, queda NaN)
      let x = parseFloat(document.getElementById("input-x").value.trim());
      let y = parseFloat(document.getElementById("input-y").value.trim());
      let h = parseFloat(document.getElementById("input-h").value.trim());
      let A = parseFloat(document.getElementById("input-A").value.trim());
      let B = parseFloat(document.getElementById("input-B").value.trim());

      // Contar cuántos valores se ingresaron
      let cont = 0;
      if (!isNaN(x)) cont++;
      if (!isNaN(y)) cont++;
      if (!isNaN(h)) cont++;
      if (!isNaN(A)) cont++;
      if (!isNaN(B)) cont++;

      const mensajeError = document.getElementById("mensaje-error");
      const resultadosDiv = document.getElementById("resultados");
      mensajeError.textContent = "";
      resultadosDiv.style.display = "none";

      if (cont < 2) {
        mensajeError.textContent = "Ingresa al menos dos valores.";
        return;
      }

      // Lógica de cálculo:
      // Trabajamos en el triángulo donde el ángulo recto es B (vértice medio-izquierda)
      // y se cumple que A + B(agudo) = 90.
      // Si se ingresan ambos ángulos (A y B), verificamos que sumen 90.
      if (!isNaN(A) && !isNaN(B)) {
        if (Math.abs(A + B - 90) > 0.5) {
          mensajeError.textContent = "Los ángulos A y B deben sumar 90°.";
          return;
        }
      }
      
      // Caso especial: si se ingresan solo ángulos, asumimos x = 1 (escala base)
      if (isNaN(x) && isNaN(y) && isNaN(h) && !isNaN(A) && !isNaN(B)) {
        x = 1;
        // Entonces y = tan(A) * x y h = √(x²+y²)
        y = Math.tan(degToRad(A));
        h = Math.sqrt(x*x + y*y);
      }

      // Según qué datos se tengan, se completan los valores faltantes
      // Caso 1: si se tienen ambos catetos, se calcula la hipotenusa
      if (!isNaN(x) && !isNaN(y) && isNaN(h)) {
        h = Math.sqrt(x*x + y*y);
        // Expresión simbólica: h = √(x²+y²)
      }
      // Caso 2: si se tiene x y h, se calcula y
      if (!isNaN(x) && isNaN(y) && !isNaN(h)) {
        if (h <= x) {
          mensajeError.textContent = "La hipotenusa debe ser mayor que el cateto horizontal.";
          return;
        }
        y = Math.sqrt(h*h - x*x);
      }
      // Caso 3: si se tiene y y h, se calcula x
      if (isNaN(x) && !isNaN(y) && !isNaN(h)) {
        if (h <= y) {
          mensajeError.textContent = "La hipotenusa debe ser mayor que el cateto vertical.";
          return;
        }
        x = Math.sqrt(h*h - y*y);
      }
      // Si se ingresa un cateto y un ángulo (A o B), se puede calcular el otro cateto y la hipotenusa
      if (!isNaN(A) && !isNaN(x) && isNaN(y) && isNaN(h)) {
        y = x * Math.tan(degToRad(A));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(A) && !isNaN(y) && isNaN(x) && isNaN(h)) {
        x = y / Math.tan(degToRad(A));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(B) && !isNaN(x) && isNaN(y) && isNaN(h)) {
        y = x * Math.tan(degToRad(B));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(B) && !isNaN(y) && isNaN(x) && isNaN(h)) {
        x = y / Math.tan(degToRad(B));
        h = Math.sqrt(x*x + y*y);
      }
      
      // Si falta algún ángulo, lo calculamos usando las relaciones del triángulo rectángulo
      if (isNaN(A) && !isNaN(x) && !isNaN(y)) {
        // Ángulo A = arctan(y/x)
        A = radToDeg(Math.atan2(y, x));
      }
      if (isNaN(B)) {
        B = 90 - A;
      }
      // Redondeamos los resultados a enteros
      let xInt = Math.round(x);
      let yInt = Math.round(y);
      let hInt = Math.round(h);
      let AInt = Math.round(A);
      let BInt = Math.round(B);

      // Preparar las expresiones simbólicas para los cálculos que involucraron raíz:
      // Si x y y fueron ingresados, se usó: h = √(x²+y²)
      let simbH = "";
      let simbX = "";
      let simbY = "";
      if (isNaN(document.getElementById("input-h").value.trim())) {
        let inside = Math.round(x*x + y*y);
        simbH = `= √(${xInt}²+${yInt}²) → ${simplifyRadical(inside)}`;
      }
      if (isNaN(document.getElementById("input-x").value.trim()) && !isNaN(h) && !isNaN(y)) {
        let inside = Math.round(h*h - y*y);
        simbX = `= √(${hInt}²-${yInt}²) → ${simplifyRadical(inside)}`;
      }
      if (isNaN(document.getElementById("input-y").value.trim()) && !isNaN(h) && !isNaN(x)) {
        let inside = Math.round(h*h - x*x);
        simbY = `= √(${hInt}²-${xInt}²) → ${simplifyRadical(inside)}`;
      }

      // Calcular las funciones trigonométricas para los ángulos A y B
      let A_rad = degToRad(AInt);
      let B_rad = degToRad(BInt);
      let sinA = Math.sin(A_rad);
      let cosA = Math.cos(A_rad);
      let tanA = Math.tan(A_rad);
      let cscA = 1/sinA;
      let secA = 1/cosA;
      let cotA = 1/tanA;
      let sinB = Math.sin(B_rad);
      let cosB = Math.cos(B_rad);
      let tanB = Math.tan(B_rad);
      let cscB = 1/sinB;
      let secB = 1/cosB;
      let cotB = 1/tanB;

      // Mostrar los resultados en la sección correspondiente
      document.getElementById("resX").textContent = xInt;
      document.getElementById("resY").textContent = yInt;
      document.getElementById("resH").textContent = hInt;
      document.getElementById("resA").textContent = AInt;
      document.getElementById("resB").textContent = BInt;

      document.getElementById("simX").textContent = simbX;
      document.getElementById("simY").textContent = simbY;
      document.getElementById("simH").textContent = simbH;

      document.getElementById("senA").textContent = Math.round(sinA*100)/100;
      document.getElementById("cosA").textContent = Math.round(cosA*100)/100;
      document.getElementById("tanA").textContent = Math.round(tanA*100)/100;
      document.getElementById("cscA").textContent = Math.round(cscA*100)/100;
      document.getElementById("secA").textContent = Math.round(secA*100)/100;
      document.getElementById("cotA").textContent = Math.round(cotA*100)/100;

      document.getElementById("senB").textContent = Math.round(sinB*100)/100;
      document.getElementById("cosB").textContent = Math.round(cosB*100)/100;
      document.getElementById("tanB").textContent = Math.round(tanB*100)/100;
      document.getElementById("cscB").textContent = Math.round(cscB*100)/100;
      document.getElementById("secB").textContent = Math.round(secB*100)/100;
      document.getElementById("cotB").textContent = Math.round(cotB*100)/100;

      resultadosDiv.style.display = "block";
    }
  </script>
</body>
</html>
