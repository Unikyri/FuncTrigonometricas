<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora Interactiva de Triángulo Rectángulo</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      background: #3f51b5;
      color: #fff;
      width: 100%;
      padding: 1rem;
      text-align: center;
    }
    .contenedor {
      position: relative;
      width: 320px;
      height: 320px;
      margin: 2rem;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    /* El SVG ocupará todo el contenedor */
    svg {
      width: 100%;
      height: 100%;
    }
    /* Posicionamiento de los inputs sobre el triángulo */
    .input-field {
      position: absolute;
      width: 50px;
      text-align: center;
      font-size: 0.9rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 2px;
    }
    /* Campo para el cateto vertical (lado izquierdo) */
    #input-y {
      top: 140px;
      left: -70px;
    }
    /* Campo para el cateto horizontal (lado inferior) */
    #input-x {
      bottom: -40px;
      left: 130px;
    }
    /* Campo para la hipotenusa (lado inclinado) */
    #input-h {
      top: 20px;
      right: -70px;
    }
    /* Campo para el ángulo en vértice A (superior izquierdo) */
    #input-A {
      top: -40px;
      left: 10px;
      width: 45px;
    }
    /* Campo para el ángulo en vértice C (inferior derecho) */
    #input-B {
      bottom: -40px;
      right: 10px;
      width: 45px;
    }
    .btn-calcular {
      margin: 1rem;
      padding: 0.8rem 1.2rem;
      background: #3f51b5;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn-calcular:hover {
      background: #303f9f;
    }
    .resultado {
      max-width: 600px;
      background: #fff;
      padding: 1rem;
      border-radius: 5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      margin-bottom: 2rem;
    }
    .resultado h3 { margin-top: 0; }
    .error { color: red; text-align: center; margin-top: 1rem; }
    .simbolo { font-style: italic; color: #555; font-size: 0.9rem; }
  </style>
</head>
<body>
  <header>
    <h1>Calculadora de Triángulo Rectángulo</h1>
    <p>Ingresa los valores directamente en el dibujo</p>
  </header>

  <!-- Contenedor del triángulo -->
  <div class="contenedor">
    <!-- Dibujo del triángulo con SVG -->
    <!-- Se usan los vértices A (50,250), B (50,50) y C (250,250) -->
    <svg viewBox="0 0 300 300">
      <!-- Triángulo (área en azul claro, borde en azul oscuro) -->
      <polygon points="50,250 50,50 250,250" fill="#e8f0fe" stroke="#3f51b5" stroke-width="2" />
      <!-- Indicador del ángulo recto en B -->
      <polyline points="50,50 70,50 70,70" fill="none" stroke="#3f51b5" stroke-width="2"/>
      <!-- Líneas de referencia (punteadas) -->
      <line x1="50" y1="250" x2="250" y2="250" stroke-dasharray="4" stroke="#999" />
      <line x1="50" y1="250" x2="50" y2="50" stroke-dasharray="4" stroke="#999" />
      <line x1="50" y1="50" x2="250" y2="250" stroke-dasharray="4" stroke="#999" />
    </svg>

    <!-- Inputs posicionados sobre el triángulo -->
    <input id="input-y" class="input-field" type="number" step="any" placeholder="y" title="Cateto vertical" />
    <input id="input-x" class="input-field" type="number" step="any" placeholder="x" title="Cateto horizontal" />
    <input id="input-h" class="input-field" type="number" step="any" placeholder="h" title="Hipotenusa" />
    <input id="input-A" class="input-field" type="number" step="any" placeholder="A°" title="Ángulo en A" />
    <input id="input-B" class="input-field" type="number" step="any" placeholder="B°" title="Ángulo en C" />
  </div>

  <button class="btn-calcular" onclick="calcular()">Calcular</button>
  <div id="mensaje-error" class="error"></div>

  <!-- Resultados -->
  <div id="resultados" class="resultado" style="display:none;">
    <h3>Resultados (redondeados a entero)</h3>
    <p><strong>Cateto horizontal (x):</strong> <span id="resX"></span> <span id="simX" class="simbolo"></span></p>
    <p><strong>Cateto vertical (y):</strong> <span id="resY"></span> <span id="simY" class="simbolo"></span></p>
    <p><strong>Hipotenusa (h):</strong> <span id="resH"></span> <span id="simH" class="simbolo"></span></p>
    <p><strong>Ángulo A (°):</strong> <span id="resA"></span></p>
    <p><strong>Ángulo C (°):</strong> <span id="resB"></span></p>
    <h4>Funciones trigonométricas</h4>
    <table border="1" cellpadding="5">
      <thead>
        <tr>
          <th></th>
          <th>Valor</th>
          <th>Fracción</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>sen A</th>
          <td id="senA"></td>
          <td id="fSenA"></td>
        </tr>
        <tr>
          <th>cos A</th>
          <td id="cosA"></td>
          <td id="fCosA"></td>
        </tr>
        <tr>
          <th>tan A</th>
          <td id="tanA"></td>
          <td id="fTanA"></td>
        </tr>
        <tr>
          <th>csc A</th>
          <td id="cscA"></td>
          <td id="fCscA"></td>
        </tr>
        <tr>
          <th>sec A</th>
          <td id="secA"></td>
          <td id="fSecA"></td>
        </tr>
        <tr>
          <th>cot A</th>
          <td id="cotA"></td>
          <td id="fCotA"></td>
        </tr>
        <tr>
          <th>sen C</th>
          <td id="senB"></td>
          <td id="fSenB"></td>
        </tr>
        <tr>
          <th>cos C</th>
          <td id="cosB"></td>
          <td id="fCosB"></td>
        </tr>
        <tr>
          <th>tan C</th>
          <td id="tanB"></td>
          <td id="fTanB"></td>
        </tr>
        <tr>
          <th>csc C</th>
          <td id="cscB"></td>
          <td id="fCscB"></td>
        </tr>
        <tr>
          <th>sec C</th>
          <td id="secB"></td>
          <td id="fSecB"></td>
        </tr>
        <tr>
          <th>cot C</th>
          <td id="cotB"></td>
          <td id="fCotB"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <script>
    // Conversión entre grados y radianes
    function degToRad(grados) { return (grados * Math.PI) / 180; }
    function radToDeg(radianes) { return (radianes * 180) / Math.PI; }

    // Función para simplificar una raíz entera (ej.: 12 -> "2√3")
    function simplifyRadical(n) {
      n = Math.round(n);
      const raiz = Math.floor(Math.sqrt(n));
      if (raiz * raiz === n) return `${raiz}`;
      for (let i = raiz; i >= 2; i--) {
        if (n % (i * i) === 0) {
          const factor = i;
          const restante = n / (i * i);
          return `${factor}√${restante}`;
        }
      }
      return `√${n}`;
    }

    // Función para aproximar un decimal a fracción usando mediantes
    function decimalToFraction(decimal, tolerance = 1e-6) {
      if (Math.abs(decimal - Math.round(decimal)) < tolerance) {
        return Math.round(decimal).toString();
      }
      let sign = decimal < 0 ? -1 : 1;
      decimal = Math.abs(decimal);
      let lower_n = 0, lower_d = 1;
      let upper_n = 1, upper_d = 0;
      while (true) {
        const mediant_n = lower_n + upper_n;
        const mediant_d = lower_d + upper_d;
        const mediant = mediant_n / mediant_d;
        if (Math.abs(decimal - mediant) < tolerance) {
          return (sign * mediant_n) + "/" + mediant_d;
        } else if (mediant < decimal) {
          lower_n = mediant_n;
          lower_d = mediant_d;
        } else {
          upper_n = mediant_n;
          upper_d = mediant_d;
        }
      }
    }

    // Función principal de cálculo
    function calcular() {
      // Obtiene los valores de los inputs (los vacíos se convierten en NaN)
      let x = parseFloat(document.getElementById("input-x").value.trim());
      let y = parseFloat(document.getElementById("input-y").value.trim());
      let h = parseFloat(document.getElementById("input-h").value.trim());
      let A = parseFloat(document.getElementById("input-A").value.trim());
      let B = parseFloat(document.getElementById("input-B").value.trim());

      // Contamos cuántos datos se ingresaron
      let datosIngresados = 0;
      if (!isNaN(x)) datosIngresados++;
      if (!isNaN(y)) datosIngresados++;
      if (!isNaN(h)) datosIngresados++;
      if (!isNaN(A)) datosIngresados++;
      if (!isNaN(B)) datosIngresados++;

      const mensajeError = document.getElementById("mensaje-error");
      const resultadosDiv = document.getElementById("resultados");
      mensajeError.textContent = "";
      resultadosDiv.style.display = "none";

      if (datosIngresados < 2) {
        mensajeError.textContent = "Ingresa al menos dos valores.";
        return;
      }

      // Si solo se ingresan ambos ángulos, asumimos un cateto base (por ejemplo, x = 1)
      if (isNaN(x) && isNaN(y) && isNaN(h) && !isNaN(A) && !isNaN(B)) {
        x = 1;
      }

      // Si se ingresó solo un ángulo, se calcula el otro (en un triángulo rectángulo, A+B=90°)
      if (!isNaN(A) && isNaN(B)) { B = 90 - A; }
      if (!isNaN(B) && isNaN(A)) { A = 90 - B; }

      // Si no se ingresaron ángulos y se tienen lados, se calcula A a partir de arctan(y/x)
      if (isNaN(A) && !isNaN(x) && !isNaN(y)) {
        A = radToDeg(Math.atan2(y, x));
        B = 90 - A;
      }

      // Según qué datos se tengan se calculan los lados faltantes
      // Caso 1: ambos catetos disponibles, se calcula h
      if (!isNaN(x) && !isNaN(y) && isNaN(h)) {
        h = Math.sqrt(x*x + y*y);
      }
      // Caso 2: x y h disponibles, se calcula y
      if (!isNaN(x) && isNaN(y) && !isNaN(h)) {
        if (h <= x) { mensajeError.textContent = "h debe ser mayor que x."; return; }
        y = Math.sqrt(h*h - x*x);
      }
      // Caso 3: y y h disponibles, se calcula x
      if (isNaN(x) && !isNaN(y) && !isNaN(h)) {
        if (h <= y) { mensajeError.textContent = "h debe ser mayor que y."; return; }
        x = Math.sqrt(h*h - y*y);
      }
      // Caso 4: si se tiene un cateto y un ángulo (A o B) y faltan h y el otro cateto
      if (!isNaN(A) && !isNaN(x) && isNaN(y) && isNaN(h)) {
        y = x * Math.tan(degToRad(A));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(A) && !isNaN(y) && isNaN(x) && isNaN(h)) {
        x = y / Math.tan(degToRad(A));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(B) && !isNaN(x) && isNaN(y) && isNaN(h)) {
        y = x * Math.tan(degToRad(B));
        h = Math.sqrt(x*x + y*y);
      }
      if (!isNaN(B) && !isNaN(y) && isNaN(x) && isNaN(h)) {
        x = y / Math.tan(degToRad(B));
        h = Math.sqrt(x*x + y*y);
      }

      // Verificar consistencia: h debe ser mayor que cada cateto
      if (!isNaN(x) && !isNaN(h) && h <= x) { mensajeError.textContent = "h debe ser mayor que x."; return; }
      if (!isNaN(y) && !isNaN(h) && h <= y) { mensajeError.textContent = "h debe ser mayor que y."; return; }

      // Redondeamos los resultados a enteros para los lados y ángulos
      let xInt = Math.round(x);
      let yInt = Math.round(y);
      let hInt = Math.round(h);
      let AInt = Math.round(A);
      let BInt = Math.round(B);

      // Preparamos las expresiones simbólicas para los lados (raíces)
      let simbH = "", simbX = "", simbY = "";
      if (isNaN(document.getElementById("input-h").value.trim()) && !isNaN(x) && !isNaN(y)) {
        let inside = Math.round(x*x + y*y);
        simbH = `= √(${xInt}²+${yInt}²) → ${simplifyRadical(inside)}`;
      }
      if (isNaN(document.getElementById("input-x").value.trim()) && !isNaN(h) && !isNaN(y)) {
        let inside = Math.round(h*h - y*y);
        simbX = `= √(${hInt}²-${yInt}²) → ${simplifyRadical(inside)}`;
      }
      if (isNaN(document.getElementById("input-y").value.trim()) && !isNaN(h) && !isNaN(x)) {
        let inside = Math.round(h*h - x*x);
        simbY = `= √(${hInt}²-${xInt}²) → ${simplifyRadical(inside)}`;
      }

      // Calculamos las funciones trigonométricas (con los ángulos redondeados)
      let A_rad = degToRad(AInt);
      let B_rad = degToRad(BInt);
      let sinA = Math.sin(A_rad), cosA = Math.cos(A_rad), tanA = Math.tan(A_rad);
      let sinB = Math.sin(B_rad), cosB = Math.cos(B_rad), tanB = Math.tan(B_rad);
      let cscA = 1/sinA, secA = 1/cosA, cotA = 1/tanA;
      let cscB = 1/sinB, secB = 1/cosB, cotB = 1/tanB;

      // Mostrar resultados numéricos y simbólicos
      document.getElementById("resX").textContent = xInt;
      document.getElementById("resY").textContent = yInt;
      document.getElementById("resH").textContent = hInt;
      document.getElementById("resA").textContent = AInt;
      document.getElementById("resB").textContent = BInt;

      document.getElementById("simX").textContent = simbX;
      document.getElementById("simY").textContent = simbY;
      document.getElementById("simH").textContent = simbH;

      // Función para actualizar cada celda con valor decimal y su aproximación en fracción
      function setTrigResult(idVal, idFrac, value) {
        let valor = Math.round(value*100)/100;
        document.getElementById(idVal).textContent = valor;
        document.getElementById(idFrac).textContent = decimalToFraction(value, 1e-6);
      }

      setTrigResult("senA", "fSenA", sinA);
      setTrigResult("cosA", "fCosA", cosA);
      setTrigResult("tanA", "fTanA", tanA);
      setTrigResult("cscA", "fCscA", cscA);
      setTrigResult("secA", "fSecA", secA);
      setTrigResult("cotA", "fCotA", cotA);

      setTrigResult("senB", "fSenB", sinB);
      setTrigResult("cosB", "fCosB", cosB);
      setTrigResult("tanB", "fTanB", tanB);
      setTrigResult("cscB", "fCscB", cscB);
      setTrigResult("secB", "fSecB", secB);
      setTrigResult("cotB", "fCotB", cotB);

      resultadosDiv.style.display = "block";
    }
  </script>
</body>
</html>
